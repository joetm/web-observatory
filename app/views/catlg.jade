extends main
block jumbotron
block content
  .row
    .btn-toolbar
      .btn-group
        a.btn.btn-default(href='/add/'+type role='button')
          span.glyphicon.glyphicon-plus 
          |  Add
      .btn-group
        a.btn.btn-default(href='/stats' role='button') 
          span.glyphicon.glyphicon-info-sign
          |  Statistics
    //else
      .hide.alert.alert-info
        = 'Please login to add and edit '+type+'s'
      a.disabled.btn.btn-primary.btn-large(href='/add/'+type)= 'Add a '+type

  .row
    div(style='height:30px') 
  .row
    #display
      table.table.table-hover
        thead
          tr
            th Name
            th Description
            th.col-md-1 Access
        tbody
          if table
            each val in table
              if val
                - val.url = '/wo/'+val.type+'#'+val._id
                tr.entry(itemscope itemtype=(val.type==='dataset'?'http://schema.org/Dataset':'http://schema.org/WebPage'))
                  //schema.org meta data
                  meta(itemprop='http://schema.org/name' content=val.name)
                  meta(itemprop='http://schema.org/url' content=val.url)
                  meta(itemprop='http://schema.org/provider' content=val.publisher_name)
                  meta(itemprop='http://schema.org/isBasedOnUrl' content=val.related)
                  meta(itemprop='http://schema.org/description' content=val.des)

                  - var name=val.name || '';
                  - if(name.length>30) {
                  -   name = name.substring(0,27);
                  -   name = name + '...';}
                  td
                    a.tp(data-toogle='tooltip' title=val.url href=val.url address='true')
                      = name

                  //display no more than 50 characters of description
                  - var des=val.des?val.des:''
                  - if(des.length>47) {
                  -   des = val.des.substring(0,50);
                  -   des = des + '...';}
                  td
                    .tp(data-toogle='tooltip' title=val.des)
                      = des

                  td
                    if val.opAcc
                      span.glyphicon.glyphicon-ok
                    else 
                      span.glyphicon.glyphicon-remove
        tfoot
          tr
            th Name
            th Description
            th Access

    #details.col-md-6


block footer
  link(href='/css/datatables.css', rel='stylesheet')
  script(src='/js/jquery.datatables.min.js')
  script(src='/js/jquery.address-1.6.js')
  script(src='/js/bt3datatables.js')
  script(src='/js/catalogue.jade.js')
