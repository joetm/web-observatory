extends main
block append nav
    include includes/toolbar-top
block jumbotron
block content
    if !user
        .row
            .alert.alert-success
                button.close(type='button' data-dismiss='alert') &times;
                | Login to reveal more features
    .row
        #display
            if table
                table.table.table-hover.header-fixed
                    thead
                        tr
                            th Name
                            th Type
                            th Description
                            th.col-md-1 Permission
                            th.col-md-1 Status
                    tbody
                        each val in table
                            if val
                                - val.url = '/wo/'+val.type+'#'+val._id
                                tr.entry(itemscope itemtype=(val.type==='dataset'?'http://schema.org/Dataset/WebObservatoryDataset':'http://schema.org/WebPage'))
                                    - var name=val.name || '';
                                    - if(name.length>30) {
                                    -   name = name.substring(0,27);
                                    -   name = name + '...';}
                                    td
                                        a(data-toogle='tooltip' title=val.url href=val.url address='true')
                                            = name
                                        //schema.org meta data
                                        meta(itemprop='http://schema.org/name' content=val.name)
                                        meta(itemprop='http://schema.org/url' content=baseUrl+val.url)
                                        meta(itemprop='http://schema.org/provider' content=val.publisher_name)
                                        meta(itemprop='http://schema.org/isBasedOnUrl' content=val.related)
                                        meta(itemprop='http://schema.org/description' content=val.des)

                                    td= val.querytype
                                    //display no more than 50 characters of description
                                    - var des=val.des?val.des:''
                                    - if(des.length>47) {
                                    -   des = val.des.substring(0,50);
                                    -   des = des + '...';}
                                    td
                                        .tp(data-toogle='tooltip' title=val.des)
                                            = des
                                    td
                                        if (!val.opAcc && (!user || val.publisher !== user.email) && (!user || !val.canAccess || val.canAccess.indexOf(user.email) === -1))
                                            span.glyphicon.glyphicon-remove
                                            .hidden false
                                        else
                                            span.glyphicon.glyphicon-ok
                                            .hidden true
                                    td
                                        if (val.alive)
                                            span.glyphicon.glyphicon-ok
                                            .hidden alive
                                        else
                                            span.glyphicon.glyphicon-remove
        .col-md-5(style='overflow:auto; float:right;')
            .row#details
            .row#querypan
block footer
    link(href='/css/typeahead.js-bootstrap.css', rel='stylesheet')
    link(href='/css/bootstrap-editable.css', rel='stylesheet')
    link(href='/css/select2.css', rel='stylesheet')
    link(href='/css/select2-bootstrap.css', rel='stylesheet')
    link(href='/css/dataTables.bootstrap.css', rel='stylesheet')
    script(src='/js/jquery.dataTables.min.js')
    script(src='/js/dataTables.bootstrap.js')
    script(src='/js/jquery.address-1.6.js')
    script(src='/js/bootstrap-editable.min.js')
    script(src='/js/inputs-ext/typeaheadjs/lib/typeahead.js')
    script(src='/js/inputs-ext/typeaheadjs/typeaheadjs.js')
    script(src='/js/select2.js')
    script(src='/js/catalogue.jade.js')
